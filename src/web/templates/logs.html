{% extends "base.html" %}

{% block body %}

<div class="container">
  <div class="d-inline">
    <h2 class="float-left">Logs</h2>
    <div class="float-right">
      <input class="form-control" id="logsInput" type="text" placeholder="Filter..">
    </div>
  </div>

  {% if error %}
  <div>{{ error }}</div>
  {% endif %}

  <div class="table">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>Application</th>
          <th>Service</th>
          <th>Environment</th>
          <th>Version</th>
          <th>Status</th>
          <th>Timestamp (UTC)</th>
        </tr>
      </thead>
      <tbody id="logsTable">
        {% for log in logs %}
        <tr>
          <td>{{ log['application'] }}</td>
          <td>{{ log['service'] }}</td>
          <td>{{ log['environment'] }}</td>
          <td>{{ log['version'] }}</td>
          <td>{{ log['status'] }}</td>
          <td>{{ log['timestamp'] | epoch_to_date }}</td>
          <td style="display:none;">{{ log['tags'] }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Filter Script -->
<script>
  $(document).ready(function(){
    $("#logsInput").on("keyup", function() {
      let value = $(this).val().toLowerCase();
      $("#logsTable tr").filter(function() {
        $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
      });
    });
  });
</script>

{% endblock %}
